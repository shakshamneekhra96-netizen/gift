<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vintage Birthday Flipbook</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cinzel:wght@400;600;700&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">

<style>
@font-face {
  font-family: 'Halimun';
  src: url('halimun-font/Halimun-W7jn.ttf') format('truetype');
}

@font-face {
  font-family: 'PerfectoCalligraphy';
  src: url('perfecto-calligraphy-personal-use/PerfectoCalligraphy.ttf') format('truetype');
}

:root {
  --page-width: min(760px, 95vw);
  --page-height: calc(var(--page-width) * 0.75);
  --shadow: rgba(0,0,0,0.36);
}

body {
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  background: linear-gradient(180deg, #fdf6ed 0%, #d2b48c 85%);
  font-family: 'IM Fell English', serif;
  overflow-x: hidden;
}

.scene {
  width: var(--page-width);
  height: var(--page-height);
  perspective: 1500px;
  position: relative;
}

.book {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
}

.page-wrap {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
}

.page {
  width: 100%;
  height: 100%;
  padding: 28px 24px;
  border-radius: 16px;
  box-shadow: 0 28px 60px var(--shadow), 0 8px 18px rgba(0,0,0,0.18),
              inset 0 2px 0 rgba(255,255,255,0.08),
              inset 0 0 0 1px rgba(58,43,31,0.12);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  background: url('image.png') no-repeat center/cover;
  background-color: #f3e6cd;
  background-blend-mode: multiply;
  transition: transform 1s cubic-bezier(.2,.8,.12,1);
  opacity: 0;
}

.page.visible {
  opacity: 1;
  transition: opacity 0.8s ease;
}

/* Cover Page */
.cover {
  background: url('cover.jpg') no-repeat center/cover;
  background-size: cover;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
  color: #3a2b1f;
  padding: 40px 20px;
}

.cover .main-title {
  font-size: clamp(2.5rem, 7vw, 4rem);
  font-family: 'IM Fell English', serif;
  text-transform: uppercase;
  letter-spacing: 4px;
  font-weight: 600;
  margin-bottom: 25px;
}

.cover .person-img {
  width: 150px;
  height: 150px;
  border-radius: 50%;
  overflow: hidden;
  border: 4px solid #3a2b1f;
  margin-bottom: 20px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.25);
}

.cover .person-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.cover .subtitle {
  font-size: clamp(1.25rem, 5.5vw, 2rem);
  margin-top: 10px;
  font-style: italic;
}

.page .note, .cover .note {
  font-size: clamp(1rem, 4vw, 1.5rem);
  line-height: 1.8;
  max-width: 82%;
  text-align: center;
  margin-top: 25px;
  font-family: 'IM Fell English', serif;
  letter-spacing: 0.3px;
}

/* Sparkle Animation */
.sparkle { pointer-events: none; position: absolute; inset: 0; z-index: 10; overflow: hidden; }
.particle { position: absolute; width: 6px; height: 6px; border-radius: 50%; background: linear-gradient(180deg, #fff8de, #f7e6b9); opacity: 0; animation: sparkle 1000ms linear forwards; box-shadow: 0 2px 6px rgba(191,160,122,0.4); }
@keyframes sparkle {
  0% { opacity: 0; transform: translateY(10px) scale(0.6) rotate(0deg); }
  25% { opacity: 1; transform: translateY(-8px) scale(1.1) rotate(8deg); }
  100% { opacity: 0; transform: translateY(-40px) scale(0.4) rotate(20deg); }
}

/* Butterfly Animation */
.butterfly {
  position: absolute;
  width: 55px;
  height: 55px;
  opacity: 0;
  background: url('ddapzle-c7909979-452f-44b2-a03e-d206fcf49d3b.gif') no-repeat center/contain;
  pointer-events: none;
  filter: drop-shadow(0 3px 5px rgba(0,0,0,0.25));
  animation: vintageButterflyFly var(--duration) ease-in-out forwards;
  transform-origin: center;
  z-index: 15;
}

@keyframes vintageButterflyFly {
  0% { opacity: 0; transform: translate(var(--start-x), var(--start-y)) scale(0.85) rotate(0deg); }
  10% { opacity: 0.8; }
  40% { transform: translate(var(--mid-x), var(--mid-y)) scale(1) rotate(var(--r1)); opacity: 1; }
  70% { transform: translate(var(--end-x), var(--end-y)) scale(1) rotate(var(--r2)); opacity: 0.9; }
  100% { opacity: 0; transform: translate(calc(var(--end-x) * 1.2), calc(var(--end-y) * 1.1)) scale(0.9) rotate(var(--r3)); }
}

/* Mobile Swipe Note */
.mobile-note {
  position: fixed;
  bottom: 18px;
  left: 50%;
  transform: translateX(-50%);
  background: transparent;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 1rem;
  font-family: 'IM Fell English', serif;
  color: #2e2218;
  text-shadow: 0 1px 2px rgba(255,255,255,0.6);
  z-index: 50;
  display: none;
}

@media (max-width: 640px) {
  :root {
    --page-width: 95vw;
    --page-height: calc(95vw * 1.85);
  }
  .mobile-note { display: block; text-align: center; width: 90vw; }
}
</style>
</head>

<body>

<div class="scene">
  <div class="book" id="book">
    <div class="page-wrap" id="pageWrap"></div>
    <div class="sparkle" id="sparkle"></div>
  </div>
  <div class="butterfly-container" id="butterflyContainer"></div>
</div>

<div class="mobile-note">Swipe left or right to turn pages</div>

<script>


// const scriptURL = "https://script.google.com/macros/s/AKfycbw0ZmMfpYFzDM4LwwbXY3Jpz8Q00-AGkj_YVToH7k82AZCrKJWHA3zk0wyUJzdYgRAv/exec";

// function getDeviceType() {
//   const ua = navigator.userAgent;
//   if (/mobile/i.test(ua)) return "Mobile";
//   if (/tablet/i.test(ua)) return "Tablet";
//   return "Desktop";
// }

// function logVisit() {
//   const visitData = {
//     time: new Date().toLocaleString(),
//     device: getDeviceType(),
//     browser: navigator.userAgent
//   };

//   fetch(scriptURL, {
//     method: 'POST',
//     mode: 'no-cors',
//     headers: { 'Content-Type': 'application/json' },
//     body: JSON.stringify(visitData)
//   });
// }

// window.onload = logVisit;
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxDQzCZFrjdixh3gKrGpzKtlmm0KpXF7nm0PlQH3WwOXWAyGvpCaF3JHNDsfV74rEI/exec"; // replace


function getDeviceType(ua) {
  ua = (ua || '').toLowerCase();
  if (/iphone/.test(ua)) return "iPhone";
  if (/ipad/.test(ua)) return "iPad";
  if (/android/.test(ua)) return "Android";
  if (/tablet/.test(ua)) return "Tablet";
  if (/mobile/.test(ua)) return "Mobile";
  return "Desktop";
}

async function logVisit() {
  const ua = navigator.userAgent || '';
  const payload = {
    ts_iso: new Date().toISOString(),
    deviceType: getDeviceType(ua),
    platform: navigator.platform || '',
    language: navigator.language || '',
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || '',
    clientHints: {}
  };

  if (navigator.userAgentData) {
    payload.clientHints.brands = navigator.userAgentData.brands || null;
  }

  try {
    fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });
  } catch (e) {
    // console.warn('Error sending data:', e);
  }


}

window.addEventListener('load', logVisit);

const pages = [
  { 
    mainTitle: "HAPPY BIRTHDAY", 
    subtitle: "Anjali Chandwani", 
    message: "Wishing you a day filled with joy, laughter, and unforgettable memories. You deserve all the happiness in the world today and always.",
    personImg: "front_photo.png" 
  },
 
  //   {
  //   "message": "Hey,\nI just wanted to say that you‚Äôre honestly the best company I could ever have. I really enjoy talking to you ‚Äî more than anyone else. I don‚Äôt even know why; maybe it‚Äôs because of the amazing energy you carry. That‚Äôs something truly rare, and it‚Äôs one of the many things I really appreciate about you. You‚Äôre always special to everyone (and I‚Äôm sure a lot of people have told you that already)."
  // },

  // {
  //   "message": "Thank you for always suggesting such good movies and series ‚Äî you seriously have great taste! And of course, thanks for teaching me chess! I had no idea how to play before, but now at least I can play a little ‚Äî all thanks to you. üòÇ You‚Äôre genuinely a wonderful person and a very special friend."
  // },
  // {
  //   "message": "You have so many talents ‚Äî you‚Äôre artistic, love doing art and craft, can play a bit of piano and the mouth organ, skilled in gardening, great at games, hardworking, and love reading. You even take really nice photos ‚Äî especially of the moon and the solar system! I just realized how talented you truly are. Seriously, you‚Äôre amazing ‚Äî keep it up and never stop being the wonderful person you are. üåô‚ú®"
  // },
  {
    "message": "For the Sweet & Wonderful Person\n----------------\n\nThis is about a sweet and wonderful girl ‚Äî someone truly special, even if she doesn‚Äôt always realize just how rare and amazing she really is."
  },
  {
    "message": "It was on February 15/16, 2024, when I saw you for the first time outside the canteen. You were wearing a black top and blue jeans, walking with your friends, smiling, and talking ‚Äî you looked really pretty. Later, I learned your name during KYT. A few months later, I moved to Marsh, and then you moved to the USA.You came back in September, and at first, I thought you were very strict. Honestly, I was a bit afraid to talk to you at first, but once we actually started talking, I realized you were completely different.I found that you‚Äôre the most"
  },
  {
    "message": "amazing company anyone could ask for, and I genuinely enjoy talking to you more than anyone else (I don‚Äôt even know why ‚Äî I just do).You‚Äôre the most genuine and real person I‚Äôve ever met ‚Äî no show-off & all ‚Äî just this soft, innocent charm, like a little cute child whose smile lifts the weight off everything around and whose presence brings a quiet, comforting peace. I really wish I could talk to you more. There‚Äôs something wonderfully different about your energy ‚Äî warm, genuine, and so easy to trust; I can‚Äôt quite explain it, but it just feels different."
  },
  {
    "message": "That energy is rare, Anjali. Whenever we talk, my day always gets better‚Äîmaybe you‚Äôre a little lucky for me. I think you‚Äôre so special to everyone not only me. Thank you for always suggesting such good movies and series‚Äîyou seriously have great taste! You‚Äôre also a really interesting person with so many skills. You‚Äôre artistic, love doing arts and crafts, can play a bit of piano and the mouth organ, are skilled in gardening, great at games (like Chess ‚Äî I‚Äôve learned from you, but obviously, I‚Äôm not as good as you.), and love reading."
  },
  {
    "message": "You take such lovely photos ‚Äî especially of the moon and that one of Saturn! I‚Äôm sure there are so many talents you have that I haven‚Äôt even discovered yet.. You truly deserve lots of appreciation ‚Äî not just for your skills, but for the person you are. I‚Äôm sure everyone admires you even more than I can imagine. Honestly, you‚Äôre such an amazing person ‚Äî so innocent‚Ä¶ well, maybe not entirely innocent, but with those little black innocent eyes, anyone would believe it. Just kidding ‚Äî but honestly, they really do!"
  },
  {"message":"Sometimes, I catch that quiet sadness behind your smile, even when you‚Äôre trying to look okay. I don‚Äôt know why others don‚Äôt see it, but somehow, I do. There are moments I want to ask if you‚Äôre alright, but the words don‚Äôt come out ‚Äî and when I finally do, you say you‚Äôre fine, even though I can feel you‚Äôre not. Maybe you think I wouldn‚Äôt understand‚Ä¶ maybe you‚Äôre right, or maybe not. But still, if you ever feel like talking ‚Äî about anything at all ‚Äî I‚Äôm here. Trust me, I‚Äôm a good listener, and I always will be."},
  {
    "message": "I thought this quote suits you perfectly ‚Äî\n‚ÄúShe carries a quiet kind of magic ‚Äî the kind that doesn‚Äôt seek attention, but leaves everything she touches a little more beautiful, a little more alive.‚Äù\n- Butterflies Rising"
  },

  // {
  //   "message": "I just want to say one last thing from my side -\n I know you don‚Äôt usually open up so easily, even when you need help, and that you try to handle everything on your own. But please remember, if you ever need anything or just want to talk, you can message or call me anytime. I‚Äôll always make time for you. It‚Äôs not something I‚Äôm just saying out of formality ‚Äî I really mean it . No matter what, I‚Äôll always be here for you."
  // },
  {
    "message": "And I know you‚Äôre not someone who opens up easily. You usually prefer to handle things on your own ‚Äî and I respect that. I also know you deal with so much  every day, carrying problems that you can‚Äôt always talk about, quietly facing them like you always do(you'tr really strog girl and that awesome). Everyone goes through that phase at some point, but it never really gets easier, does it? Still, I want you to remember this ‚Äî no matter what‚Äôs happening, whether you‚Äôre feeling stressed, lost, happy, or even just a little bored ‚Äî I‚Äôm here for you. And if you ever need help, especially in those quiet moments, please don‚Äôt think twice about reaching out."
  },
  {
    "message": "Sometimes, when the sun goes down and the stars appear, you might find yourself sitting alone, thinking about things you can‚Äôt share with anyone. Some days are full of smiles, but when evening comes, there‚Äôs a stillness ‚Äî the kind that makes your heart feel heavy and your mind restless. In those moments, let your thoughts wander. Take a deep breath. Maybe talk to someone ‚Äî even a small conversation can bring peace. And if you ever need to talk, don‚Äôt hesitate. No one is ever too busy to listen. I don‚Äôt know about others, but for you, I never am.I‚Äôd truly like to listen ‚Äî to be there for you, to share those quiet moments, big or small. So if you ever feel like talking, call or message me anytime.I‚Äôll always make time for you."
  },
  {
    "message": "You may not believe it, but to me, you‚Äôre an amazing person with a good heart. I‚Äôm sure many people have told you that in their own ways ‚Äî because it‚Äôs true. But for me, you‚Äôre someone special ‚Äî a person whose company I genuinely enjoy and whose vibe feels trusted and comforting. You know, sometimes I think about that quiet moment with friends maybe you‚Äôve felt it too, when frustration or a bit of sadness makes your heart heavy.You sit there silently, surrounded by people, but not really wanting to talk, and a few tears slip down as your little black eyes shine with tiny drops of water. In that moment, you look so soft, so real and too cute. Let those tears fall, close your eyes, take a deep breath, and go to your best friends; talk about any random, silly thing ‚Äî it really helps."
  },
  {
    "message": "I once read that ‚ÄúEven the purest heart has the allure of darkness.‚Äù And I think that‚Äôs true ‚Äî we all carry both light and shadow within us. But when I look at you, I mostly see light. Even the parts you call ‚Äòdark‚Äô just make you more human, more real ‚Äî and honestly, even more beautiful.\nI‚Äôm not a good writer, but I wrote this for you ‚Äî\n‚ÄúYour smile brings peace to every heart,\nEven your silence feels like an art.\nYour heart is pure, your kindness true,\nAnd it shows in everything you do.\nIf you were a star, you‚Äôd outshine the moon,\nYou‚Äôre simply good, like a child ‚Äî that‚Äôs the truth about you.‚Äù"
  },


  {
    "message": "Many, many Happiest Birthdays Again! \nAlways keep that cute smile just like you always do, and stay happy ‚Äî the only thing that truly matters ‚ú®"
  }
];

let index = 0;
const book = document.getElementById('book');
const pageWrap = document.getElementById('pageWrap');
const sparkle = document.getElementById('sparkle');

function escapeHtml(str){ if(!str) return ''; return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\r?\n/g,'<br/>'); }

function showButterfly() {
  const container = document.getElementById('butterflyContainer');
  const count = Math.floor(Math.random() * 2) + 2; // 2‚Äì3 butterflies
  for (let i = 0; i < count; i++) {
    const butterfly = document.createElement('div');
    butterfly.className = 'butterfly';
    const duration = (3.2 + Math.random() * 1.0) + 's';
    butterfly.style.setProperty('--duration', duration);
    butterfly.style.left = (10 + Math.random() * 80) + '%';
    butterfly.style.bottom = '-60px';
    butterfly.style.setProperty('--start-x', (Math.random() * 200 - 100) + 'px');
    butterfly.style.setProperty('--start-y', (Math.random() * 80 + 500) + 'px');
    butterfly.style.setProperty('--mid-x', (Math.random() * 200 - 100) + 'px');
    butterfly.style.setProperty('--mid-y', (-100 - Math.random() * 100) + 'px');
    butterfly.style.setProperty('--end-x', (Math.random() * 200 - 100) + 'px');
    butterfly.style.setProperty('--end-y', (-250 - Math.random() * 150) + 'px');
    butterfly.style.setProperty('--r1', (Math.random() * 20 - 10) + 'deg');
    butterfly.style.setProperty('--r2', (Math.random() * 25 - 15) + 'deg');
    butterfly.style.setProperty('--r3', (Math.random() * 30 - 10) + 'deg');
    butterfly.style.animationDelay = (Math.random() * 0.5) + 's';
    container.appendChild(butterfly);
    setTimeout(() => butterfly.remove(), 4500);
  }
}

function showSparkle(){
  sparkle.innerHTML='';
  for(let i=0;i<6;i++){
    const el=document.createElement('div'); 
    el.className='particle';
    el.style.left=(20+Math.random()*60)+'%';
    el.style.top=(40+Math.random()*30)+'%';
    el.style.animationDelay=(i*80)+'ms';
    sparkle.appendChild(el);
    setTimeout(()=>{el.remove();},1400);
  }
}

const flipSound = new Audio('page-flip-47177.mp3');
function playFlipSound() {
  flipSound.currentTime = 0;
  flipSound.play();
}

function animateFlip(){
  playFlipSound();
  book.style.transition = 'transform 0.6s ease';
  book.style.transform = 'rotateY(-10deg)';
  setTimeout(()=>{ book.style.transform='rotateY(0deg)'; },300);
  showSparkle();
  showButterfly();
}

function render(){
  pageWrap.innerHTML = '';
  const current = pages[index];
  const pageNode = document.createElement('section');
  pageNode.className = 'page';
  
  if(current.mainTitle){
    pageNode.classList.add('cover');
    pageNode.innerHTML = `
      <div class="main-title">${escapeHtml(current.mainTitle)}</div>
      ${current.personImg ? `<div class="person-img"><img src="${current.personImg}" alt="Person"></div>` : ''}
      <div class="subtitle">${escapeHtml(current.subtitle)}</div>
      <div class="note">${escapeHtml(current.message)}</div>`;
  } else {
    pageNode.innerHTML = `<div class="note">${escapeHtml(current.message)}</div>`;
  }

  pageWrap.appendChild(pageNode);
  setTimeout(()=>{ pageNode.classList.add('visible'); }, 100);
}

document.addEventListener('keydown',e=>{
  if(e.key==='ArrowRight'||e.key==='PageDown'){ if(index<pages.length-1){ index++; animateFlip(); render(); } }
  if(e.key==='ArrowLeft'||e.key==='PageUp'){ if(index>0){ index--; animateFlip(); render(); } }
});

let touchStartX=0;
document.addEventListener('touchstart',e=>{ touchStartX=e.touches[0].clientX; },{passive:true});
document.addEventListener('touchend',e=>{
  const dx=e.changedTouches[0].clientX-touchStartX;
  if(Math.abs(dx)>40){ 
    if(dx<0 && index<pages.length-1){ index++; animateFlip(); render(); }
    else if(dx>0 && index>0){ index--; animateFlip(); render(); }
  }
});

render();
</script>
</body>
</html>
