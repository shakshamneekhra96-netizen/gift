<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vintage Birthday Flipbook</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cinzel:wght@400;600;700&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">
<style>
@font-face {
  font-family: 'Halimun';
  src: url('halimun-font/Halimun-W7jn.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

@font-face {
  font-family: 'PerfectoCalligraphy';
  src: url('perfecto-calligraphy-personal-use/PerfectoCalligraphy.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
}

:root {
  --page-width: min(760px, 95vw);
  --page-height: calc(var(--page-width) * 0.75);
  --shadow: rgba(0,0,0,0.36);
}

body {
  margin:0;
  padding:24px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  background: linear-gradient(180deg, #fdf6ed 0%, #d2b48c 85%);
  font-family: 'IM Fell English', serif;
  /* keep content visible above fixed controls on mobile (incl. iPhone safe area) */
  padding-bottom: calc(90px + env(safe-area-inset-bottom));
}

.scene {
  width: var(--page-width);
  perspective: 1500px;
  position: relative;
  margin-bottom:80px; /* space for fixed buttons */
}

.book {
  width: 100%;
  height: var(--page-height);
  position: relative;
  transform-style: preserve-3d;
}

.page-wrap {
  position: absolute;
  inset: 0;
  display:flex;
  justify-content:center;
  pointer-events:none;
}

.page {
  width:100%;
  height:100%;
  padding:28px 24px;
  border-radius:16px;
  box-shadow: 0 28px 60px var(--shadow), 0 8px 18px rgba(0,0,0,0.18), inset 0 2px 0 rgba(255,255,255,0.08), inset 0 0 0 1px rgba(58,43,31,0.12);
  display:flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  text-align: center;
  pointer-events: auto;
  color: #3a2b1f;
  background: url('image.png') no-repeat center/cover;
  background-size: cover;
  background-color: #f3e6cd;
  background-blend-mode: multiply;
  transition: transform 1s cubic-bezier(.2,.8,.12,1);
  opacity:0;
}

.page.visible {
  opacity:1;
  transition: opacity 0.8s ease;
}

.cover {
  background: url('cover.jpg') no-repeat center/cover;
  background-size: cover;
  display:flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #3a2b1f;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
}

.cover .main-title {
  font-size: clamp(2rem, 8vw, 3.5rem);
  font-family: 'IM Fell English', serif;
  margin-bottom: 25px;
  text-transform: uppercase;
  letter-spacing: 4px;
  font-weight: 600;
}

.cover .person-img {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  overflow: hidden;
  border: 4px solid #3a2b1f;
  margin-bottom: 20px;
  box-shadow: 0 4px 14px rgba(0,0,0,0.25);
}

.cover .person-img img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.cover .subtitle {
  font-size: clamp(1.25rem, 5.5vw, 2rem);
  margin: 10px 0 0 0;
  font-family: 'IM Fell English', serif;
  font-style: italic;
}

.page .note, .cover .note {
  font-size: clamp(1rem, 4.2vw, 1.4rem);
  line-height: 1.9;
  max-width: 82%;
  text-align: center;
  margin-top: 20px;
  font-family: 'IM Fell English', serif;
  letter-spacing: 0.2px;
}

/* Buttons fixed at bottom center */
.controls {
  display:flex;
  gap:12px;
  justify-content:center;
  align-items:center;
  position: fixed;
  bottom: calc(14px + env(safe-area-inset-bottom));
  left:50%;
  transform: translateX(-50%);
  background: rgba(255,255,255,0.15);
  padding: 6px 12px;
  border-radius: 12px;
  z-index: 10;
  flex-wrap: wrap;
}

.btn {
  background: linear-gradient(180deg, rgba(255,255,255,0.4), rgba(200,200,200,0.1));
  border:1px solid rgba(0,0,0,0.3);
  padding:10px 14px;
  border-radius:12px;
  cursor:pointer;
  box-shadow: 0 6px 12px rgba(0,0,0,0.2);
  color: black;
  font-size:1.1rem;
  font-weight:600;
  font-family: 'IM Fell English', serif;
  transition: transform 160ms ease, box-shadow 160ms ease;
}
.btn:hover { transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,0.25); }
.btn:active { transform: translateY(1px); }
.btn[disabled]{ opacity:0.48; cursor:not-allowed; }

.sparkle { pointer-events:none; position:absolute; inset:0; z-index:10; overflow:hidden; }
.particle { position:absolute; width:6px; height:6px; border-radius:50%; background:linear-gradient(180deg, #fff8de, #f7e6b9); opacity:0; transform:translate3d(0,0,0) scale(0.8); animation: sparkle 1000ms linear forwards; box-shadow:0 2px 6px rgba(191,160,122,0.4); }
@keyframes sparkle{ 0%{ opacity:0; transform:translateY(10px) scale(0.6) rotate(0deg) } 25%{ opacity:1; transform:translateY(-8px) scale(1.1) rotate(8deg) } 100%{ opacity:0; transform:translateY(-40px) scale(0.4) rotate(20deg) } }

/* Small helper note for phones */
.mobile-note{
  position: fixed;
  bottom: calc(14px + env(safe-area-inset-bottom));
  left: 50%;
  transform: translateX(-50%);
  background: transparent; /* transparent overlay on page */
  border: none;
  padding: 8px 12px;
  border-radius: 10px;
  font-size: 1rem;
  font-family: 'IM Fell English', serif;
  color: #2e2218;
  text-shadow: 0 1px 2px rgba(255,255,255,0.6); /* keep readable on textures */
  /* remove blur to avoid softness on mobile */
  z-index: 50; /* ensure it covers the page */
  display: none; /* hidden by default, shown on small screens */
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
}

/* Responsive adjustments */
@media(max-width:640px){ 
  /* Keep a consistent mobile page size */
  :root{ --page-width: 95vw; --page-height: calc(95vw * 1.85);} 
  body{ padding:16px; padding-bottom: calc(90px + env(safe-area-inset-bottom)); }
  .cover .main-title{ margin-bottom:15px; letter-spacing:3px;}
  .cover .note, .page .note{ max-width:90%; margin-top:15px;} 
  .cover .person-img { width: 130px; height: 130px; margin-bottom:15px; }
  /* Ensure mobile pages are exactly 185% of width */
  .book{ height: var(--page-height); }
  .page, .cover { height: var(--page-height); }
  .page{ padding:18px 14px; }
  .btn{ font-size:1rem; padding:8px 10px;}
  .mobile-note { width: 80%; max-width: 92vw; }
  /* hide buttons and show helper note on phones */
  .controls{ display:none; }
  .mobile-note{ display:block; bottom: calc(18px + env(safe-area-inset-bottom)); max-width: 90vw; text-align:center; }
}

/* Responsive adjustments */
@media(max-width:440px){ 
  .cover .main-title{ font-size: clamp(2.2rem, 9vw, 3.8rem); }
  .cover .subtitle{ font-size: clamp(1.5rem, 6.5vw, 2.2rem); }
  .page .note, .cover .note{ font-size: clamp(1.1rem, 4.8vw, 1.6rem); }
  .btn{ font-size: 1.15rem; }
  .mobile-note{ font-size: 1.05rem; }
  /* inherit --page-height from 640px rule for stability */
}

.page, .cover {
  display: flex;
  flex-direction: column;
  justify-content: center; /* vertically center */
  align-items: center;     /* horizontally center */
  text-align: center;
  width: 100%;
  height: 100%;
  padding: 20px;
  box-sizing: border-box;
  background-size: cover;
  color: #3a2b1f;
}

.page .note, .cover .note {
  font-size: calc(1rem + 0.8vw); /* dynamically scales */
  line-height: 1.6;
  max-width: 80%;
  word-wrap: break-word;
}

/* ===============================
   Vintage Drift Butterflies ü¶ã
   =============================== */
   .butterfly {
  position: absolute;
  width: 55px;
  height: 55px;
  opacity: 0;
  background: url('ddapzle-c7909979-452f-44b2-a03e-d206fcf49d3b.gif') no-repeat center/contain;
  pointer-events: none;
  filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.25));
  animation: vintageButterflyFly var(--duration) ease-in-out forwards;
  transform-origin: center;
  z-index: 15;
}

@keyframes vintageButterflyFly {
  0% {
    opacity: 0;
    transform: translate(var(--start-x), var(--start-y)) scale(0.85) rotate(0deg);
  }
  10% {
    opacity: 0.8;
  }
  40% {
    transform: translate(var(--mid-x), var(--mid-y)) scale(1) rotate(var(--r1));
    opacity: 1;
  }
  70% {
    transform: translate(var(--end-x), var(--end-y)) scale(1) rotate(var(--r2));
    opacity: 0.9;
  }
  100% {
    opacity: 0;
    transform: translate(calc(var(--end-x) * 1.2), calc(var(--end-y) * 1.1)) scale(0.9) rotate(var(--r3));
  }
}


/* remove duplicate conflicting control block; above definition handles layout */

</style>
</head>
<body>

  <div class="scene">
    <div class="book" id="book">
      <div class="page-wrap" id="pageWrap"></div>
      <div class="sparkle" id="sparkle"></div>
    </div>
    <div class="butterfly-container" id="butterflyContainer"></div>
  </div>
  

<div class="controls">
  <button class="btn" id="prevBtn">üëà Left</button>
  <button class="btn" id="nextBtn">Right üëâ</button>
</div>

<div class="mobile-note">Swipe left or right to turn pages</div>

<script>
const pages = [
  { 
    mainTitle:"HAPPY BIRTHDAY", 
    subtitle:"Anjali Chandwani", 
    message:"Wishing you a day filled with joy, love, and beautiful memories.", 
    personImg:"front_photo.png" 
  },
//   {
//   "message": "Hey,\nI just wanted to say that you‚Äôre honestly the best company I could ever have. I really enjoy talking to you ‚Äî more than anyone else. I don‚Äôt even know why; maybe it‚Äôs because of the amazing energy you carry. That‚Äôs something truly rare, and it‚Äôs one of the many things I really appreciate about you. You‚Äôre always special to everyone (and I‚Äôm sure a lot of people have told you that already)."
// },

// {
//   "message": "Thank you for always suggesting such good movies and series ‚Äî you seriously have great taste! And of course, thanks for teaching me chess! I had no idea how to play before, but now at least I can play a little ‚Äî all thanks to you. üòÇ You‚Äôre genuinely a wonderful person and a very special friend."
// },
// {
//   "message": "You have so many talents ‚Äî you‚Äôre artistic, love doing art and craft, can play a bit of piano and the mouth organ, skilled in gardening, great at games, hardworking, and love reading. You even take really nice photos ‚Äî especially of the moon and the solar system! I just realized how talented you truly are. Seriously, you‚Äôre amazing ‚Äî keep it up and never stop being the wonderful person you are. üåô‚ú®"
// },
{
  "message": "For the Sweet & Wonderful Person\n----------------\n\nThis is about a sweet and wonderful girl ‚Äî someone truly special, even if she doesn‚Äôt always realize just how rare and amazing she really is."
}

,
{
  "message": "It was on February 15/16, 2024, when I saw you for the first time outside the canteen. You were wearing a black top and blue jeans, walking with your friends, smiling, and talking ‚Äî you looked truly amazing. Later, I learned your name during KYT. A few months later, I moved to Marsh, and then you moved to the USA.You came back in September, and at first, I thought you were very strict."
},
{
  "message": "Honestly, I was a bit afraid to talk to you at first. But once we actually started talking, I realized you were completely different. I found that you‚Äôre one of the most amazing people I could ever talk to, and I genuinely enjoy talking to you more than anyone else. (I really wish I could talk to you more.) Maybe it‚Äôs because of the wonderful energy you carry."
},
{
  "message": "That energy is rare, and whenever we talk, my day always gets better‚Äîmaybe you‚Äôre a little lucky for me. I think you‚Äôre so special to everyone. Thank you for always suggesting such good movies and series‚Äîyou seriously have great taste! You‚Äôre also a really interesting person with so many skills. You‚Äôre artistic, love doing arts and crafts, can play a bit of piano and the mouth organ, are skilled in gardening, great at games (like Chess ‚Äî I‚Äôve learned from you, but obviously, I‚Äôm not as good as you.), and love reading."
},
{
  "message": "You take such lovely photos ‚Äî especially of the moon and that Saturn one! I‚Äôm sure there are so many talents you have that I don‚Äôt even know about yet. You truly deserve lots of appreciation ‚Äî for your skills, and just for being you (and I‚Äôm sure everyone appreciates you even more than I imagined). To be honest, you‚Äôre an amazing person ‚Äî such an innocent girl‚Ä¶ well, maybe not entirely innocent, but with those little black eyes, anyone would believe it anyway. Just kidding ‚Äî but genuinely!"
},
{
  "message": "I thought this quote suits you perfectly ‚Äî\n‚ÄúShe carries a quiet kind of magic ‚Äî the kind that doesn‚Äôt seek attention, but leaves everything she touches a little more beautiful, a little more alive.‚Äù\n- Butterflies Rising"
},

{
  "message": "I just want to say one last thing from my side -\n I know you don‚Äôt usually open up, even when you need help, and that you try to handle everything on your own. But please remember, if you ever need anything or just want to talk, you can message or call me anytime. I‚Äôll always make time for you. It‚Äôs not something I‚Äôm just saying out of formality ‚Äî I really mean it . No matter what, I‚Äôll always be here for you."
},
{
  "message": "Many, many happiest birthdays again! ü•≥ \nAlways keep that cute smile just like you always do, and stay happy ‚Äî the only thing that truly matters ‚ú®"
}
];

let index=0;
const book=document.getElementById('book');
const pageWrap=document.getElementById('pageWrap');
const sparkle=document.getElementById('sparkle');

function escapeHtml(str){ if(!str) return ''; return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\r?\n/g,'<br/>'); }
function showButterfly() {
  const container = document.getElementById('butterflyContainer');
  const count = Math.floor(Math.random() * 2) + 2; // 2‚Äì3 butterflies

  for (let i = 0; i < count; i++) {
    const butterfly = document.createElement('div');
    butterfly.className = 'butterfly';

    // Duration (3.2 ‚Äì 4.2s)
    const duration = (3.2 + Math.random() * 1.0) + 's';
    butterfly.style.setProperty('--duration', duration);

    // Start positions (from bottom or corners)
    const startX = (Math.random() * window.innerWidth * 0.8 - 200) + 'px';
    const startY = (Math.random() * 50 + 500) + 'px'; // below bottom
    const midX = (Math.random() * 200 - 100) + 'px';
    const midY = (-100 - Math.random() * 100) + 'px';
    const endX = (Math.random() * 200 - 100) + 'px';
    const endY = (-250 - Math.random() * 150) + 'px';

    // Soft rotations
    butterfly.style.setProperty('--r1', (Math.random() * 20 - 10) + 'deg');
    butterfly.style.setProperty('--r2', (Math.random() * 25 - 15) + 'deg');
    butterfly.style.setProperty('--r3', (Math.random() * 30 - 10) + 'deg');

    // Horizontal starting offset (bottom edges)
    butterfly.style.left = (10 + Math.random() * 80) + '%';
    butterfly.style.bottom = '-60px';

    butterfly.style.setProperty('--start-x', startX);
    butterfly.style.setProperty('--start-y', startY);
    butterfly.style.setProperty('--mid-x', midX);
    butterfly.style.setProperty('--mid-y', midY);
    butterfly.style.setProperty('--end-x', endX);
    butterfly.style.setProperty('--end-y', endY);

    // Slight delay between each for realism
    butterfly.style.animationDelay = (Math.random() * 0.5) + 's';

    container.appendChild(butterfly);

    // Auto remove after animation ends
    setTimeout(() => butterfly.remove(), 4500);
  }
}


function render(){
    pageWrap.innerHTML='';
    const current = pages[index];
    const pageNode=document.createElement('section');
    pageNode.className='page right';
    
    if(current.mainTitle){
      pageNode.classList.add('cover');
      pageNode.innerHTML=`<div class="cover">
        <div class="main-title">${escapeHtml(current.mainTitle)}</div>
        ${current.personImg ? `<div class="person-img"><img src="${current.personImg}" alt="CEO" /></div>` : ''}
        <div class="subtitle">${escapeHtml(current.subtitle)}</div>
        <div class="note">${escapeHtml(current.message)}</div>
      </div>`;
    } else {
      pageNode.innerHTML=`<div class="note">${escapeHtml(current.message)}</div>`;
    }

    pageWrap.appendChild(pageNode);
    setTimeout(()=>{ pageNode.classList.add('visible'); },100);
}
const flipSound = new Audio('page-flip-47177.mp3');

// Function to play sound
function playFlipSound() {
  flipSound.currentTime = 0; // reset to start
  flipSound.play();
}

// Example usage: call this inside your page flip function
function animateFlip(){
  playFlipSound(); // play sound
  book.style.transition = 'transform 0.6s ease';
  book.style.transform = 'rotateY(-10deg)';
  setTimeout(()=>{ book.style.transform='rotateY(0deg)'; },300);
  showSparkle();
  showButterfly();
}
// // Animate flip effect
// function animateFlip(){
//     book.style.transition='transform 0.6s ease';
//     book.style.transform='rotateY(-10deg)';
//     setTimeout(()=>{ book.style.transform='rotateY(0deg)'; },300);
//     showSparkle();
// }

function showSparkle(){
  sparkle.innerHTML='';
  for(let i=0;i<6;i++){
    const el=document.createElement('div'); 
    el.className='particle';
    el.style.left=(20+Math.random()*60)+'%';
    el.style.top=(40+Math.random()*30)+'%';
    el.style.animationDelay=(i*80)+'ms';
    sparkle.appendChild(el);
    setTimeout(()=>{el.remove();},1400);
  }
}

// Button navigation
document.getElementById('nextBtn').addEventListener('click',()=>{ if(index<pages.length-1){ index++; animateFlip(); render(); } });
document.getElementById('prevBtn').addEventListener('click',()=>{ if(index>0){ index--; animateFlip(); render(); } });

// Keyboard navigation
document.addEventListener('keydown',e=>{
  if(e.key==='ArrowRight'||e.key==='PageDown') document.getElementById('nextBtn').click();
  if(e.key==='ArrowLeft'||e.key==='PageUp') document.getElementById('prevBtn').click();
});

// Swipe gestures
let touchStartX=0;
document.addEventListener('touchstart',e=>{ touchStartX=e.touches[0].clientX; },{passive:true});
document.addEventListener('touchend',e=>{
  const dx=e.changedTouches[0].clientX-touchStartX;
  if(Math.abs(dx)>40){ dx<0?document.getElementById('nextBtn').click():document.getElementById('prevBtn').click(); }
});

render();
</script>

</body>
</html>
